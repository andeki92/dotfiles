---
description: 
globs: *.zsh
alwaysApply: false
---
# Zsh Configuration Guidelines

## Overview

This document describes the structure and best practices for managing Zsh configuration in a modular, XDG-compliant dotfiles repository. It follows the ](mdc:999-mdc-format.mdc) for clarity and maintainability.

## File Structure and Load Order

Zsh config files are organized by directory and numeric prefix to clarify which files are loaded eagerly (base), lazily (lazy/), or as aliases:

- **Base directory**: Eager configs, plugin loaders, functions, and aliases (with numeric prefixes for order)
- **lazy/**: All deferred/lazy-loaded configs (with numeric prefixes for order)

| Number | Purpose/Type                | Example Filename(s)           | Description                                 |
|--------|-----------------------------|-------------------------------|---------------------------------------------|
| 00-09  | Core/Eager (always loaded)  | 00-platform.zsh, 05-env.zsh   | Platform, env, XDG, path, no-defer, etc.    |
| 10-19  | Plugin Loader(s)            | 10-brew.zsh, 15-defer.zsh     | Homebrew, zsh-defer, plugin managers        |
| 20-39  | Eager Shell Features        | 20-history.zsh, 30-prompt.zsh | History, prompt, minimal completions        |
| 40-69  | Lazy/Deferred Plugins       | lazy/40-completion.zsh        | fzf, starship, zsh-completions, etc.        |
| 90-99  | Aliases (always last)       | 90-aliases.zsh, 91-brew-aliases.zsh | Aliases, must be loaded after everything    |

## Example Directory Structure

```
config/zsh/
├── .config/
│   └── zsh/
│       ├── 00-platform.zsh
│       ├── 05-no-defer.zsh
│       ├── 10-brew.zsh
│       ├── 15-defer.zsh
│       ├── 20-history.zsh
│       ├── 30-prompt.zsh
│       ├── 90-aliases.zsh
│       ├── 91-brew-aliases.zsh
│       ├── plugins/
│       │   └── zsh-defer/
│       │       └── zsh-defer.zsh
│       └── lazy/
│           ├── 40-completion.zsh
│           └── ...
└── README.md
```

## Loader Example

In your `.zshrc` or main entrypoint, use this to source everything in order:

```zsh
for file in $XDG_CONFIG_HOME/zsh/*.zsh(N); do
  source "$file"
done
for file in $XDG_CONFIG_HOME/zsh/lazy/*.zsh(N); do
  source "$file"
done
```

## Best Practices

- **Eager files**: Only include what is needed for shell startup, platform detection, and environment setup.
- **Lazy files**: Use `zsh-defer` to load heavy plugins and completions after prompt appears.
- **Aliases**: Always load last, after all functions and plugins.
- **XDG compliance**: All config files should live under `$XDG_CONFIG_HOME/zsh/`.
- **Version control**: All plugins and custom scripts should be tracked in the dotfiles repo.
- **Modularity**: Each file shouldonsd clear numeric prefix.

## Updating the Configuration

- When adding a new config file, choose a numeric prefix based on its type (see table above).
- For new plugins, add them to `plugins/` and load them with `zsh-defer` in a `lazy/` file.
- Keep this README up to date with any structural changes.

## References
- [999-mdc-format.mdc](mdc:999-mdc-format.mdc)
- [zsh-defer](https://github.com/romkatv/zsh-defer)
